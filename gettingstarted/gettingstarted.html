

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Getting Started &mdash; famafrench 0.1.2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="famafrench.FamaFrench" href="generated/famafrench.FamaFrench.html" />
    <link rel="prev" title="What’s New?!" href="../whatsnew/whatsnew.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> famafrench
          

          
          </a>

          
            
            
              <div class="version">
                0.1.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../whatsnew/whatsnew.html">What's New?!</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="generated/famafrench.FamaFrench.html">famafrench.FamaFrench</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#creating-an-instance-of-the-famafrench-class">Creating an Instance of the <code class="docutils literal notranslate"><span class="pre">FamaFrench</span></code> Class</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../applications/applications.html">Applications and Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wrdsconnection/wrdsconnection.html">Connecting to the WRDS cloud server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wrdscloudquery/wrdscloudquery.html">WRDS Query Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../portfolios/factorregressions.html">Estimating Market Betas and Rolling Residual Variances</a></li>
<li class="toctree-l1"><a class="reference internal" href="../portfolios/portfoliosorting.html">Constructing Portfolios and Return-Based Factors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kflibrary/kflibrary.html">Comparing to Ken French's Online Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../statistics-diagnostics/statistics.html">Summary Statistics and Diagnostics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils/utils.html">Auxiliary Functions and Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changes/changes.html">Change Log</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">famafrench</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Getting Started</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/gettingstarted/gettingstarted.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="getting-started">
<span id="gettingstarted"></span><h1>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>The main tool provided by the package is the <code class="docutils literal notranslate"><span class="pre">FamaFrench</span></code> class that enables its user to construct
a multitude of datasets found in <a class="reference external" href="https://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html">Ken French’s online library</a> as well as many others.</p>
<p>Datasets include portfolio returns (<cite>value</cite>- or <cite>equal</cite>-weighted), number of firms in each portfolio, or <cite>average</cite> anomaly portfolio characteristics. The sample dataset will be for a pre-specified frequency and range of dates characterized by a start and end date.</p>
<p>In addition, and of utmost interest to most users, the <code class="docutils literal notranslate"><span class="pre">FamaFrench</span></code> class enables one to construct some of the most studied Fama-French-style factors:</p>
<blockquote>
<div><ul class="simple">
<li><p>Market Premium (<code class="docutils literal notranslate"><span class="pre">MKT-RF</span></code>)</p></li>
<li><p>Small Minus Big (<code class="docutils literal notranslate"><span class="pre">SMB</span></code>)</p></li>
<li><p>High Minus Low (<code class="docutils literal notranslate"><span class="pre">HML</span></code>)</p></li>
<li><p>Momentum based on Prior (2-12) returns (<code class="docutils literal notranslate"><span class="pre">MOM</span></code>)</p></li>
<li><p>Short-Term Reversal based on Prior (1-1) returns (<code class="docutils literal notranslate"><span class="pre">ST_Rev</span></code>)</p></li>
<li><p>Long-Term Reversal based on Prior (13-60) returns (<code class="docutils literal notranslate"><span class="pre">LT_Rev</span></code>)</p></li>
</ul>
</div></blockquote>
<p>In almost all applications, the package requires the use of the constructor function <a class="reference internal" href="generated/famafrench.FamaFrench.html#famafrench.FamaFrench" title="famafrench.FamaFrench"><code class="xref py py-class docutils literal notranslate"><span class="pre">FamaFrench</span></code></a>:</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="generated/famafrench.FamaFrench.html#famafrench.FamaFrench" title="famafrench.FamaFrench"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FamaFrench</span></code></a></p></td>
<td><p><p>Class providing tools for constructing and replicating datasets from <a class="reference external" href="https://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html">Ken French’s online library</a> via queries to CRSP, Compustat Fundamentals Annual, and other sources accessed through <a class="reference external" href="https://wrds-www.wharton.upenn.edu/">wrds-cloud</a>.</p>
</p></td>
</tr>
</tbody>
</table>
<p>The constructor function makes use of an altered set of routines borrowed from the <a class="reference external" href="https://github.com/wharton/wrds">WRDS-Py library</a> to query <a class="reference external" href="http://www.crsp.org/products/research-products/crsp-us-stock-databases">CRSP</a>, <a class="reference external" href="https://wrds-web.wharton.upenn.edu/wrds/support/Data/_001Manuals%20and%20Overviews/_001Compustat/_001North%20America%20-%20Global%20-%20Bank/_000dataguide/index.cfm0">Compustat Fundamentals Annual</a>, and other datafiles provided by <cite>Wharton Research Data Services</cite> <a class="reference external" href="https://wrds-web.wharton.upenn.edu/wrds/support/">(WRDS)</a>. To use the <code class="docutils literal notranslate"><span class="pre">famafrench</span></code> package, a user <strong>must</strong> have a subscription to both CRSP and Compustat Fundamentals Annual through WRDS. See <a class="reference internal" href="../wrdsconnection/wrdsconnection.html#connecting-to-wrds-cloud"><span class="std std-ref">Connecting to wrds-cloud</span></a>.</p>
<p>Alterations of routines borrowed from the <a class="reference external" href="https://github.com/wharton/wrds">WRDS-Py library</a> enable a user with access to WRDS to add his/her WRDS username and password to their local environment. This is achieved through the use of environment variables via <code class="xref py py-func docutils literal notranslate"><span class="pre">os.environ()</span></code>, a mapping object in Python’s <a class="reference external" href="https://docs.python.org/3/library/os.html#module-os" title="(in Python v3.8)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">os</span></code></a> module that represents the user’s environment variables. Environment variables provide secure means of storing usernames and passwords. Use of and modifications to the <a class="reference external" href="https://github.com/wharton/wrds">WRDS-Py library</a> abide by its permissive MIT license (see <a class="reference external" href="https://github.com/christianjauregui/famafrench/blob/master/LICENSE.txt">LICENSE</a>).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To securely set up the WRDS username and password as environment variables:</p>
<ol class="arabic simple">
<li><p>If it does not exist already, create an <code class="docutils literal notranslate"><span class="pre">.env</span></code> file in your home directory. This should be the same directory where <code class="docutils literal notranslate"><span class="pre">~/.bash_profile</span></code> is stored.</p></li>
<li><p>Open <code class="docutils literal notranslate"><span class="pre">~/.bash_profile</span></code> and add the following: <code class="docutils literal notranslate"><span class="pre">source</span> <span class="pre">~/.env</span></code>. In <code class="docutils literal notranslate"><span class="pre">.env</span></code>, you add your WRDS username and password as environment variables as follows:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">WRDS_USERNAME</span><span class="o">=</span><span class="s2">&quot;FILL IN&quot;</span>
<span class="nb">export</span> <span class="nv">WRDS_PASSWORD</span><span class="o">=</span><span class="s2">&quot;FILL IN&quot;</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>This can also be done directly in Python:</p></li>
</ol>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;WRDS_USERNAME&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;FILL IN&quot;</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;WRDS_PASSWORD&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;FILL IN&quot;</span>
</pre></div>
</div>
</div>
<p>Having set up the WRDS username and password, connecting remotely to WRDS through <cite>wrds-cloud</cite> is made
simple through the constructor <a class="reference internal" href="../wrdsconnection/generated/famafrench.wrdsconnect.wrdsConnection.html#famafrench.wrdsconnect.wrdsConnection" title="famafrench.wrdsconnect.wrdsConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">wrdsConnection</span></code></a>. This constructor is repeatedly used within the main package constructor <a class="reference internal" href="generated/famafrench.FamaFrench.html#famafrench.FamaFrench" title="famafrench.FamaFrench"><code class="xref py py-class docutils literal notranslate"><span class="pre">FamaFrench</span></code></a>.</p>
</div>
<div class="section" id="creating-an-instance-of-the-famafrench-class">
<h2>Creating an Instance of the <code class="docutils literal notranslate"><span class="pre">FamaFrench</span></code> Class<a class="headerlink" href="#creating-an-instance-of-the-famafrench-class" title="Permalink to this headline">¶</a></h2>
<p>Instances of the <a class="reference internal" href="generated/famafrench.FamaFrench.html#famafrench.FamaFrench" title="famafrench.FamaFrench"><code class="xref py py-class docutils literal notranslate"><span class="pre">FamaFrench</span></code></a> object will vary depending on whether the user wants to construct Fama-French-style factors <strong>or</strong> portfolio returns (<cite>value</cite>- or <cite>equal</cite>-weighted), number of firms in each portfolio, and <cite>average</cite> anomaly portfolio characteristics.</p>
<p>For both types of instances, the frequency of portfolios <code class="xref py py-attr docutils literal notranslate"><span class="pre">freqType</span></code> as well as the starting and end dates must be specified. Both starting and ending dates must be in <a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.date" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.date</span></code></a> format. In addition, attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">runQuery</span></code> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code> depending on whether the user prefers to query all datafiles from <cite>wrds-cloud</cite> from scratch or whether previously queried and locally-saved datafiles are pickled in constructing the instance. The latter choice is particularly useful when updating data following a new set of observation points released by WRDS. Making use of previously queried and locally-saved datafiles significantly speeds up run-time and execution of code.</p>
<p>For example, to construct the <strong>Fama-French 3 factors</strong>: the <cite>Market Premium</cite> <code class="docutils literal notranslate"><span class="pre">MKT-RF</span></code>, <cite>Small Minus Big</cite> <code class="docutils literal notranslate"><span class="pre">SMB</span></code>, and <cite>High Minus Low</cite> <code class="docutils literal notranslate"><span class="pre">HML</span></code>, at the monthly frequency (from 1960 to the present, or the most recent date for which there is stock returns data available in CRPS and fundamentals data in Compustat), we execute the following lines of Python code:</p>
<p><strong>Fama-French 3 Factors:</strong></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">datetime</span> <span class="k">as</span> <span class="nn">dt</span>
<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">famafrench.famafrench</span> <span class="k">as</span> <span class="nn">ff</span>

<span class="gp">In [3]: </span><span class="n">startDate</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">1960</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">In [4]: </span><span class="n">endDate</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span>
<span class="gp">In [5]: </span><span class="n">runQuery</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">In [6]: </span><span class="n">ffFreq</span> <span class="o">=</span> <span class="s1">&#39;M&#39;</span>
<span class="gp">In [7]: </span><span class="n">ffsortCharac</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ME&#39;</span><span class="p">,</span> <span class="s1">&#39;BM&#39;</span><span class="p">]</span>
<span class="gp">In [8]: </span><span class="n">ffFactors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;MKT-RF&#39;</span><span class="p">,</span> <span class="s1">&#39;SMB&#39;</span><span class="p">,</span> <span class="s1">&#39;HML&#39;</span><span class="p">]</span>
<span class="gp">In [9]: </span><span class="n">ff3</span> <span class="o">=</span> <span class="n">ff</span><span class="o">.</span><span class="n">FamaFrench</span><span class="p">(</span><span class="n">runQuery</span><span class="p">,</span> <span class="n">ffFreq</span><span class="p">,</span> <span class="n">ffsortCharac</span><span class="p">,</span> <span class="n">ffFactors</span><span class="p">)</span>

<span class="gp">In [10]: </span><span class="n">factorsTableM</span> <span class="o">=</span> <span class="n">ff3</span><span class="o">.</span><span class="n">getFFfactors</span><span class="p">(</span><span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">)</span>

<span class="go">CRSP (monthly) dataset currently NOT saved locally w/ required dates. Querying from wrds-cloud...</span>
<span class="go">CRSP delisted returns (monthly) dataset currently NOT saved locally. Querying from wrds-cloud...</span>
<span class="go">Compustat (annual) dataset currently NOT saved locally. Querying from wrds-cloud...</span>
<span class="go">CRSP-Compustat merged linktable currently NOT saved locally. Querying from wrds-cloud...</span>
<span class="go">Constructing Fama-French return factor(s): 100%|██████████| 2/2 [00:03&lt;00:00,  1.73s/it]</span>
<span class="go">Historical risk-free interest rate (monthly) dataset currently NOT saved locally. Querying from wrds-cloud...</span>

<span class="gp">In [11]: </span><span class="n">factorsTableM</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="gh">Out[11]:</span>
<span class="go">                 mkt    mkt-rf       smb       hml</span>
<span class="go">date</span>
<span class="go">1960-01-31 -0.066497 -0.069797  0.017755  0.025267</span>
<span class="go">1960-02-29  0.014547  0.011647  0.006323 -0.010965</span>
<span class="go">1960-03-31 -0.012873 -0.016373 -0.001480 -0.034610</span>
<span class="go">1960-04-30 -0.015113 -0.017013 -0.001671 -0.008266</span>
<span class="go">1960-05-31  0.033918  0.031218  0.022134 -0.040884</span>
</pre></div>
</div>
<ul class="simple">
<li><p>To construct Fama-French-style factors, <code class="xref py py-attr docutils literal notranslate"><span class="pre">factorsId</span></code> (here, passed as parameter <code class="docutils literal notranslate"><span class="pre">ffFactors</span></code>) must be passed as a list of strings with the names of the factors per the naming convention outlined in the documentation for <a class="reference internal" href="generated/famafrench.FamaFrench.html#famafrench.FamaFrench" title="famafrench.FamaFrench"><code class="xref py py-class docutils literal notranslate"><span class="pre">FamaFrench</span></code></a>.</p></li>
<li><p>Although one can pass the anomaly portfolio characteristics used for portfolio sorting in the construction of the factors, <code class="xref py py-attr docutils literal notranslate"><span class="pre">sortCharacsId</span></code> (here, passed as parameter <code class="docutils literal notranslate"><span class="pre">ffsortCharac</span></code>), the constructor does not require this. Here, <code class="xref py py-attr docutils literal notranslate"><span class="pre">mainCharacsId</span></code> is also not required for obvious reasons (when omitted, <code class="xref py py-attr docutils literal notranslate"><span class="pre">mainCharacsId</span></code> is set to <code class="xref py py-attr docutils literal notranslate"><span class="pre">sortCharacsId</span></code> by default).</p></li>
</ul>
<p>We can compare the constructed factors to those provided by <a class="reference external" href="https://mba.tuck.dartmouth.edu/pages/faculty/ken.french/Data_Library/f-f_factors.html">Ken French</a>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [12]: </span><span class="n">kffactorsTableM</span> <span class="o">=</span> <span class="n">ff3</span><span class="o">.</span><span class="n">getkfFFfactors</span><span class="p">(</span><span class="n">ffFreq</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">)</span>
<span class="gp">In [13]: </span><span class="n">kffactorsTableM</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="gh">Out[13]:</span>
<span class="go">               mkt  mkt-rf     smb     hml</span>
<span class="go">1960-01-31 -0.0665 -0.0698  0.0209  0.0273</span>
<span class="go">1960-02-29  0.0146  0.0117  0.0051 -0.0199</span>
<span class="go">1960-03-31 -0.0128 -0.0163 -0.0051 -0.0285</span>
<span class="go">1960-04-30 -0.0152 -0.0171  0.0031 -0.0223</span>
<span class="go">1960-05-31  0.0339  0.0312  0.0121 -0.0376</span>

<span class="gp">In [14]: </span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="o">=</span> <span class="n">ff3</span><span class="o">.</span><span class="n">comparePortfolios</span><span class="p">(</span><span class="s1">&#39;Factors&#39;</span><span class="p">,</span> <span class="n">ffFreq</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">)</span>

<span class="go">CRSP (monthly) dataset currently NOT saved locally w/ required dates. Querying from wrds-cloud...</span>
<span class="go">CRSP delisted returns (monthly) dataset currently NOT saved locally. Querying from wrds-cloud...</span>
<span class="go">Compustat (annual) dataset currently NOT saved locally. Querying from wrds-cloud...</span>
<span class="go">CRSP-Compustat merged linktable currently NOT saved locally. Querying from wrds-cloud...</span>
<span class="go">Constructing Fama-French return factor(s): 100%|██████████| 2/2 [00:03&lt;00:00,  1.78s/it]</span>
<span class="go">Historical risk-free interest rate (monthly) dataset currently NOT saved locally. Querying from wrds-cloud...</span>
<span class="go">*********************************** Factor Returns: 1960-01-31 to 2020-03-31 ***********************************</span>

<span class="go">   *********************** Observation frequency: M ************************</span>
<span class="go">Fama-French factors: Correlation matrix:</span>
<span class="go">        mkt  mkt-rf    smb    hml</span>
<span class="go">corr:  1.0     1.0  0.978  0.976</span>

<span class="go">Fama-French factors: Average matrix:</span>
<span class="go">                          mkt        mkt-rf           smb           hml</span>
<span class="go">[wrds, kflib]:  [0.87, 0.87]  [0.51, 0.51]  [0.15, 0.15]  [0.28, 0.28]</span>

<span class="go">Fama-French factors: Std Deviation matrix:</span>
<span class="go">                          mkt        mkt-rf           smb           hml</span>
<span class="go">[wrds, kflib]:  [4.39, 4.39]  [4.41, 4.41]  [3.01, 3.01]  [2.87, 2.87]</span>

<span class="go">Elapsed time:  5.372  seconds.</span>
</pre></div>
</div>
<ul class="simple">
<li><p>The instance method <a class="reference internal" href="../statistics-diagnostics/generated/famafrench.FamaFrench.comparePortfolios.html#famafrench.FamaFrench.comparePortfolios" title="famafrench.FamaFrench.comparePortfolios"><code class="xref py py-meth docutils literal notranslate"><span class="pre">FamaFrench.comparePortfolios</span></code></a> compares our constructed factors with those provided by French at the same frequency over the same sample period. Current output of the method includes sample <cite>Pearson correlations</cite>, sample <cite>means</cite>, and sample <cite>standard deviations</cite>.</p></li>
</ul>
<p><strong>Other examples:</strong> To form the 6 (ie 2 x 3) monthly, portfolios (also from 1960 to the present, or the most recent date for which there is stock returns data available in CRPS and fundamentals data in Compustat) sorted on <cite>Size</cite> <code class="docutils literal notranslate"><span class="pre">ME</span></code> and <cite>Book-to-Market</cite> <code class="docutils literal notranslate"><span class="pre">BM</span></code> and construct the <cite>value</cite>-weighted portfolio returns, number of firms in each portfolio, and the <cite>average</cite> anomaly portfolio characteristics used in the construction of the portfolios: market value of equity <code class="docutils literal notranslate"><span class="pre">ME</span></code> and book-to-market equity <code class="docutils literal notranslate"><span class="pre">BM</span></code>, we execute the following lines of Python code:</p>
<p><cite>Value</cite> <strong>-weighted portfolio returns:</strong></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">datetime</span> <span class="k">as</span> <span class="nn">dt</span>
<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">famafrench.famafrench</span> <span class="k">as</span> <span class="nn">ff</span>

<span class="gp">In [3]: </span><span class="n">startDate</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">1960</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">In [4]: </span><span class="n">endDate</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span>
<span class="gp">In [5]: </span><span class="n">runQuery</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">In [6]: </span><span class="n">ffFreq</span> <span class="o">=</span> <span class="s1">&#39;M&#39;</span>
<span class="gp">In [7]: </span><span class="n">sortingDim</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="gp">In [8]: </span><span class="n">retType</span> <span class="o">=</span> <span class="s1">&#39;vw&#39;</span>

<span class="gp">In [9]: </span><span class="n">ffsortCharac</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ME&#39;</span><span class="p">,</span> <span class="s1">&#39;BM&#39;</span><span class="p">]</span>
<span class="gp">In [10]: </span><span class="n">ffFactors</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">In [11]: </span><span class="n">me_bm_2x3</span> <span class="o">=</span> <span class="n">ff</span><span class="o">.</span><span class="n">FamaFrench</span><span class="p">(</span><span class="n">runQuery</span><span class="p">,</span> <span class="n">ffFreq</span><span class="p">,</span> <span class="n">ffsortCharac</span><span class="p">,</span> <span class="n">ffFactors</span><span class="p">)</span>

<span class="gp">In [12]: </span><span class="n">returnsTableM</span> <span class="o">=</span> <span class="n">me_bm_2x3</span><span class="o">.</span><span class="n">getPortfolioReturns</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">,</span> <span class="n">sortingDim</span><span class="p">,</span> <span class="n">retType</span><span class="p">)</span>

<span class="go">CRSP (monthly) dataset currently NOT saved locally w/ required dates. Querying from wrds-cloud...</span>
<span class="go">CRSP delisted returns (monthly) dataset currently NOT saved locally w/ required dates. Querying from wrds-cloud...</span>
<span class="go">Compustat (annual) dataset currently NOT saved locally w/ required dates. Querying from wrds-cloud...</span>

<span class="gp">In [13]: </span><span class="n">returnsTableM</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go">Out [13]:</span>
<span class="go">            me0-50_bm0-30  me0-50_bm30-70  ...  me50-100_bm30-70  me50-100_bm70-100</span>
<span class="go">date</span>
<span class="go">1960-01-31      -0.065363       -0.053950  ...         -0.045400          -0.071003</span>
<span class="go">1960-02-29       0.022127        0.006104  ...          0.038354          -0.014447</span>
<span class="go">1960-03-31      -0.013744       -0.031140  ...         -0.013633          -0.054888</span>
<span class="go">1960-04-30      -0.010691       -0.016785  ...         -0.020938          -0.014375</span>
<span class="go">1960-05-31       0.043435        0.035750  ...          0.010110          -0.017830</span>

<span class="gp">In [14]: </span><span class="n">kfreturnsTableM</span> <span class="o">=</span> <span class="n">me_bm_2x3</span><span class="o">.</span><span class="n">getkfPortfolioReturns</span><span class="p">(</span><span class="n">ffFreq</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">,</span> <span class="n">sortingDim</span><span class="p">,</span> <span class="n">retType</span><span class="p">)</span>
<span class="gp">In [15]: </span><span class="n">kfreturnsTableM</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go">Out [15]:</span>
<span class="go">            small lobm   me1 bm2  small hibm  big lobm   me2 bm2  big hibm</span>
<span class="go">1960-01-31   -0.057876 -0.031988   -0.029368 -0.082071 -0.043931 -0.055931</span>
<span class="go">1960-02-29    0.020772  0.014530    0.005015  0.013139  0.022903 -0.010929</span>
<span class="go">1960-03-31   -0.023385 -0.024016   -0.038293 -0.008789 -0.010768 -0.050967</span>
<span class="go">1960-04-30    0.000545 -0.021162   -0.029614 -0.015721 -0.013525 -0.030143</span>
<span class="go">1960-05-31    0.053034  0.018239    0.023730  0.043100  0.018242 -0.002716</span>

<span class="gp">In [16]: </span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="o">=</span> <span class="n">me_bm_2x3</span><span class="o">.</span><span class="n">comparePortfolios</span><span class="p">(</span><span class="s1">&#39;Returns&#39;</span><span class="p">,</span> <span class="n">ffFreq</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">,</span> <span class="n">sortingDim</span><span class="p">,</span> <span class="n">retType</span><span class="p">)</span>

<span class="go">CRSP (monthly) dataset currently NOT saved locally w/ required dates. Querying from wrds-cloud...</span>
<span class="go">CRSP delisted returns (monthly) dataset currently NOT saved locally w/ required dates. Querying from wrds-cloud...</span>
<span class="go">Compustat (annual) dataset currently NOT saved locally w/ required dates. Querying from wrds-cloud...</span>
<span class="go">*********************************** ME x BM (2 x 3) ************************************</span>
<span class="go">    *********************** Observation frequency: M ************************</span>
<span class="go">    ************************* Returns: 1960-01-31 to 2020-03-31 **************************</span>

<span class="go">Correlation matrix:</span>
<span class="go">          bm0-30 bm30-70 bm70-100</span>
<span class="go"> me0-50     0.99    0.99    0.994</span>
<span class="go"> me50-100  0.997   0.982    0.984</span>

<span class="go"> Average matrix:</span>
<span class="go">                    bm0-30         bm30-70        bm70-100</span>
<span class="go"> me0-50    [0.82%, 0.84%]  [1.11%, 1.15%]  [1.28%, 1.26%]</span>
<span class="go"> me50-100  [0.87%, 0.88%]  [0.92%, 0.88%]  [0.97%, 1.01%]</span>

<span class="go"> Std Deviation matrix:</span>
<span class="go">                    bm0-30        bm30-70        bm70-100</span>
<span class="go"> me0-50    [6.68%, 6.69%]  [5.47%, 5.4%]  [5.62%, 5.63%]</span>
<span class="go"> me50-100  [4.55%, 4.54%]  [4.2%, 4.28%]  [5.06%, 4.91%]</span>

<span class="go"> Elapsed time:  84.751  seconds.</span>
</pre></div>
</div>
<p><strong>Number of firms in each portfolio:</strong></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [16]: </span><span class="n">firmsTableM</span> <span class="o">=</span> <span class="n">me_bm_2x3</span><span class="o">.</span><span class="n">getNumFirms</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">,</span> <span class="n">sortingDim</span><span class="p">)</span>
<span class="gp">In [17]: </span><span class="n">firmsTableM</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go">Out [17]:</span>
<span class="go">            me0-50_bm0-30  me0-50_bm30-70  ...  me50-100_bm30-70  me50-100_bm70-100</span>
<span class="go">date                                       ...</span>
<span class="go">1960-01-31             21              49  ...                69                 27</span>
<span class="go">1960-02-29             21              49  ...                69                 27</span>
<span class="go">1960-03-31             21              49  ...                69                 27</span>
<span class="go">1960-04-30             21              49  ...                69                 27</span>
<span class="go">1960-05-31             21              49  ...                69                 27</span>

<span class="gp">In [18]: </span><span class="n">kffirmsTableM</span> <span class="o">=</span> <span class="n">me_bm_2x3</span><span class="o">.</span><span class="n">getkfNumFirms</span><span class="p">(</span><span class="n">ffFreq</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">,</span> <span class="n">sortingDim</span><span class="p">)</span>
<span class="gp">In [19]: </span><span class="n">kffirmsTableM</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go">Out [19]:</span>
<span class="go">            small lobm  me1 bm2  small hibm  big lobm  me2 bm2  big hibm</span>
<span class="go">1960-01-31          66      193         223       228      199        72</span>
<span class="go">1960-02-29          66      193         222       228      199        72</span>
<span class="go">1960-03-31          66      192         222       228      199        72</span>
<span class="go">1960-04-30          66      190         221       228      199        72</span>
<span class="go">1960-05-31          66      187         221       228      199        72</span>

<span class="gp">In [20]: </span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="o">=</span> <span class="n">me_bm_2x3</span><span class="o">.</span><span class="n">comparePortfolios</span><span class="p">(</span><span class="s1">&#39;NumFirms&#39;</span><span class="p">,</span> <span class="n">ffFreq</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">,</span> <span class="n">sortingDim</span><span class="p">)</span>

<span class="go">*********************************** ME x BM (2 x 3) ************************************</span>
<span class="go">    *********************** Observation frequency: M ************************</span>
<span class="go">    ************************* NumFirms: 1960-01-31 to 2020-03-31 **************************</span>

<span class="go">Correlation matrix:</span>
<span class="go">          bm0-30 bm30-70 bm70-100</span>
<span class="go">me0-50     0.99   0.969     0.98</span>
<span class="go">me50-100  0.894   0.854     0.93</span>

<span class="go">Average matrix:</span>
<span class="go">               bm0-30     bm30-70      bm70-100</span>
<span class="go">me0-50    [857, 877]  [878, 902]  [1022, 1014]</span>
<span class="go">me50-100  [336, 358]  [282, 302]    [124, 135]</span>

<span class="go">Std Deviation matrix:</span>
<span class="go">               bm0-30     bm30-70    bm70-100</span>
<span class="go">me0-50    [501, 479]  [400, 362]  [522, 458]</span>
<span class="go">me50-100   [124, 96]    [79, 49]    [45, 34]</span>

<span class="go">Elapsed time:  7.179  seconds.</span>
</pre></div>
</div>
<p><cite>Equal</cite> <strong>-weighted average firm size</strong> <code class="docutils literal notranslate"><span class="pre">ME</span></code> <strong>and</strong> <cite>Value</cite> <strong>-weighted average</strong> <code class="docutils literal notranslate"><span class="pre">BM</span></code> <strong>for each portfolio:</strong></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [16]: </span><span class="n">characsTableM</span> <span class="o">=</span> <span class="n">me_bm_2x3</span><span class="o">.</span><span class="n">getCharacs</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">,</span> <span class="n">sortingDim</span><span class="p">)</span>
<span class="gp">In [17]: </span><span class="k">for</span> <span class="n">charac</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">me_bm_2x3</span><span class="o">.</span><span class="n">mainCharacsId</span><span class="p">):</span>
<span class="go">             print(charac, &#39;\n&#39;, characsTableM[charac].head())</span>

<span class="go">ME</span>

<span class="go">me_bm_port  me0-50_bm0-30  me0-50_bm30-70  ...  me50-100_bm30-70  me50-100_bm70-100</span>
<span class="go">date                                       ...</span>
<span class="go">1960-01-31      50.358714       44.536747  ...        625.549871         376.082398</span>
<span class="go">1960-02-29      50.358714       44.536747  ...        625.549871         376.082398</span>
<span class="go">1960-03-31      50.358714       44.536747  ...        625.549871         376.082398</span>
<span class="go">1960-04-30      50.358714       44.536747  ...        625.549871         376.082398</span>
<span class="go">1960-05-31      50.358714       44.536747  ...        625.549871         376.082398</span>

<span class="go">[5 rows x 6 columns]</span>
<span class="go">BM</span>

<span class="go">me_bm_port  me0-50_bm0-30  me0-50_bm30-70  ...  me50-100_bm30-70  me50-100_bm70-100</span>
<span class="go">date                                       ...</span>
<span class="go">1960-01-31       0.442664        0.835413  ...          0.715368           1.495814</span>
<span class="go">1960-02-29       0.443257        0.835101  ...          0.716441           1.495995</span>
<span class="go">1960-03-31       0.444962        0.834058  ...          0.716098           1.479376</span>
<span class="go">1960-04-30       0.444282        0.834749  ...          0.715577           1.470528</span>
<span class="go">1960-05-31       0.442410        0.834351  ...          0.716156           1.474706</span>

<span class="go">[5 rows x 6 columns]</span>

<span class="gp">In [18]: </span><span class="n">kfcharacsTableM</span> <span class="o">=</span> <span class="n">me_bm_2x3</span><span class="o">.</span><span class="n">getkfCharacs</span><span class="p">(</span><span class="n">ffFreq</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">,</span> <span class="n">sortingDim</span><span class="p">)</span>
<span class="gp">In [19]: </span><span class="k">for</span> <span class="n">charac</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">me_bm_2x3</span><span class="o">.</span><span class="n">mainCharacsId</span><span class="p">):</span>
<span class="go">             print(charac, &#39;\n&#39;, kfcharacsTableM[charac].head())</span>
<span class="go">ME</span>

<span class="go">            small lobm  me1 bm2  small hibm  big lobm  me2 bm2  big hibm</span>
<span class="go">1960-01-31       37.66    31.88       21.40    743.00   405.35    239.89</span>
<span class="go">1960-02-29       35.48    30.82       20.81    681.54   386.94    226.11</span>
<span class="go">1960-03-31       36.12    31.09       20.85    687.18   393.99    222.53</span>
<span class="go">1960-04-30       35.11    30.35       19.99    679.88   388.21    210.41</span>
<span class="go">1960-05-31       35.12    29.88       19.38    668.63   382.39    203.68</span>
<span class="go">BM</span>

<span class="go">            small lobm  me1 bm2  small hibm  big lobm  me2 bm2  big hibm</span>
<span class="go">1960-01-31      0.4158   0.8464      1.7597    0.3443   0.7227    1.6961</span>
<span class="go">1960-02-29      0.4163   0.8457      1.7650    0.3454   0.7226    1.7006</span>
<span class="go">1960-03-31      0.4171   0.8449      1.7559    0.3429   0.7220    1.6942</span>
<span class="go">1960-04-30      0.4181   0.8440      1.7532    0.3412   0.7209    1.6762</span>
<span class="go">1960-05-31      0.4175   0.8428      1.7422    0.3395   0.7201    1.6721</span>

<span class="gp">In [20]: </span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="o">=</span> <span class="n">me_bm_2x3</span><span class="o">.</span><span class="n">comparePortfolios</span><span class="p">(</span><span class="s1">&#39;Characs&#39;</span><span class="p">,</span> <span class="n">ffFreq</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">,</span> <span class="n">sortingDim</span><span class="p">)</span>

<span class="go">CRSP (monthly) dataset currently NOT saved locally w/ required dates. Querying from wrds-cloud...</span>
<span class="go">CRSP delisted returns (monthly) dataset currently NOT saved locally w/ required dates. Querying from wrds-cloud...</span>
<span class="go">Compustat (annual) dataset currently NOT saved locally w/ required dates. Querying from wrds-cloud...</span>
<span class="go">*********************************** ME x BM (2 x 3) ************************************</span>
<span class="go">    *********************** Observation frequency: M ************************</span>
<span class="go"> ************************* (Characteristic: ME): 1960-01-31 to 2020-03-31 ***************************</span>

<span class="go">Correlation matrix:</span>
<span class="go">           bm0-30 bm30-70 bm70-100</span>
<span class="go"> me0-50    0.909   0.943    0.955</span>
<span class="go"> me50-100  0.991    0.93    0.975</span>

<span class="go">Average matrix:</span>
<span class="go">                       bm0-30             bm30-70           bm70-100</span>
<span class="go">me0-50      [267.22, 237.67]     [247.94, 229.2]   [142.76, 135.05]</span>
<span class="go">me50-100  [8813.02, 8892.67]  [6534.32, 6296.73]  [5314.71, 5675.8]</span>

<span class="go">Std Deviation matrix:</span>
<span class="go">                       bm0-30             bm30-70            bm70-100</span>
<span class="go">me0-50      [352.29, 269.64]     [297.92, 254.2]     [170.9, 147.65]</span>
<span class="go">me50-100  [9671.32, 9921.44]  [8240.16, 7200.64]  [6635.95, 6998.62]</span>

<span class="go">*********************************** ME x BM (2 x 3) ************************************</span>
<span class="go">    *********************** Observation frequency: M ************************</span>
<span class="go"> ************************* (Characteristic: BM): 1960-01-31 to 2020-03-31 ***************************</span>

<span class="go">Correlation matrix:</span>
<span class="go">           bm0-30 bm30-70 bm70-100</span>
<span class="go">me0-50    0.996   0.994    0.972</span>
<span class="go">me50-100  0.991   0.992    0.723</span>

<span class="go">Average matrix:</span>
<span class="go">                 bm0-30       bm30-70      bm70-100</span>
<span class="go">me0-50     [0.3, 0.31]  [0.71, 0.73]  [1.43, 1.51]</span>
<span class="go">me50-100  [0.28, 0.29]  [0.68, 0.71]   [1.3, 1.32]</span>

<span class="go">Std Deviation matrix:</span>
<span class="go">                  bm0-30       bm30-70      bm70-100</span>
<span class="go">me0-50    [0.13, 0.13]  [0.28, 0.28]  [0.53, 0.55]</span>
<span class="go">me50-100  [0.12, 0.12]  [0.27, 0.27]   [0.6, 0.47]</span>


<span class="go">Elapsed time:  68.136  seconds.</span>
</pre></div>
</div>
<ul class="simple">
<li><p>If attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">mainCharacsId</span></code> is not specified (as in the example above), then the class constructor sets it to <code class="xref py py-attr docutils literal notranslate"><span class="pre">sortCharacsId</span></code> (here, passed as parameter <code class="docutils literal notranslate"><span class="pre">ffsortCharac</span></code>).</p></li>
<li><p>Since the focus is on constructing portfolios, not factors, <code class="xref py py-attr docutils literal notranslate"><span class="pre">factorsId</span></code> (here, passed as parameter <code class="docutils literal notranslate"><span class="pre">ffFactors</span></code>) is set to an empty list.</p></li>
<li><p>Lastly, <code class="xref py py-attr docutils literal notranslate"><span class="pre">sortingDim</span></code> is set to <code class="docutils literal notranslate"><span class="pre">[2,</span> <span class="pre">3]</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">retType</span></code> is set to <code class="docutils literal notranslate"><span class="pre">vw</span></code> in order to form the 6 (ie 2 x 3) portfolios.</p></li>
</ul>
<p>More applications and detailed examples are provided in <a class="reference internal" href="../applications/applications.html#applications-and-examples"><span class="std std-ref">Applications and Examples</span></a>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="generated/famafrench.FamaFrench.html" class="btn btn-neutral float-right" title="famafrench.FamaFrench" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../whatsnew/whatsnew.html" class="btn btn-neutral float-left" title="What’s New?!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Christian Jauregui

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>